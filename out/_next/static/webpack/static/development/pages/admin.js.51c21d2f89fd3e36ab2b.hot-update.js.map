{"version":3,"file":"static/webpack/static/development/pages/admin.js.51c21d2f89fd3e36ab2b.hot-update.js","sources":["webpack:///./components/AdminPostsList.js"],"sourcesContent":["import React, { Component } from \"react\";\nimport { some } from \"lodash\";\nimport styled from \"styled-components\";\n\nimport Search from \"./Search\";\nimport ListItem from \"./ListItem\";\n\nconst PostItem = styled.div`\n  display: flex;\n`;\n\nexport default class PostsList extends Component {\n  constructor(props) {\n    super(props);\n\n    this.keys = {};\n\n    this.state = {\n      showNeedsWork: false\n    };\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"keydown\", this.handleKeyPress);\n    document.addEventListener(\"keyup\", this.handleKeyPress);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keydown\", this.handleKeyPress);\n    document.removeEventListener(\"keyup\", this.handleKeyPress);\n  }\n\n  onNewPostClick = () => {\n    this.props.onSetPost({\n      published: false,\n      slug: \"\",\n      title: \"\",\n      description: \"\",\n      subtitle: \"\",\n      image_url: \"\",\n      image_url_small: \"\",\n      references: \"\",\n      html: `<div class=\"writing\">\n  <h3>Initial</h3>\n</div>`,\n      date_added: \"\",\n      related_posts_tags: [],\n      mapped_related_posts_tags: [],\n      tag_ids: [],\n      tags: []\n    });\n  };\n\n  handleKeyPress = e => {\n    this.keys[e.keyCode] = e.type === \"keydown\";\n\n    if (this.keys[17] && this.keys[78]) {\n      this.setState({ showNeedsWork: !this.state.showNeedsWork });\n    }\n  };\n\n  needsWork(post) {\n    const errors = [];\n\n    if (!post.published) {\n      errors.push(\"Not published\");\n    }\n\n    if (!post.tags.length) {\n      errors.push(\"No tags\");\n    }\n\n    if (!post.related_posts_tags) {\n      errors.push(\"No related posts\");\n    }\n\n    if (!post.description || post.description.length < 160) {\n      errors.push(\"Needs description\");\n    }\n\n    return errors;\n  }\n\n  renderAll() {\n    return this.props.posts.map(post => {\n      return (\n        <PostItem key={post.id} onClick={() => this.props.onSetPost(post)}>\n          <div>{post.title}</div>\n          {post.image_url_small ? (\n            <img src={post.image_url_small} alt={post.title} />\n          ) : null}\n        </PostItem>\n      );\n    });\n  }\n\n  renderNeedsWork() {\n    const { onSetPost, posts, postsBySlug, tags } = this.props;\n\n    return (\n      <div>\n        {/* {posts.map(post => {\n          if (post.tags.length) {\n            return null;\n          }\n\n          return (\n            <div key={post.id} onClick={() => onSetPost(post)}>\n              <div>{post.title}</div>\n              <div style={{ color: \"red\" }}>Needs tag</div>\n            </div>\n          );\n        })} */}\n        {tags.map(tag => {\n          if (tag.slug === \"apologetics\" || tag.slug === \"theology\") {\n            return null;\n          }\n\n          return (\n            <div key={tag.id} className=\"writing\">\n              {some(\n                tag.posts,\n                post => this.needsWork(postsBySlug[post.slug]).length\n              ) ? (\n                <div>\n                  <h4 className=\"nomargin\">{tag.title}</h4>\n                  {tag.posts.map(post => {\n                    const needsWork = this.needsWork(postsBySlug[post.slug]);\n\n                    if (!needsWork.length) {\n                      return null;\n                    }\n\n                    const needsWorkErrors = needsWork.map(error => {\n                      return (\n                        <div key={error} style={{ color: \"red\" }}>\n                          {error}\n                        </div>\n                      );\n                    });\n\n                    return (\n                      <div key={post.id} onClick={() => onSetPost(post)}>\n                        <div>{post.title}</div>\n                        {needsWorkErrors}\n                      </div>\n                    );\n                  })}\n                </div>\n              ) : null}\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n\n  render() {\n    const { showNeedsWork } = this.state;\n    const { posts } = this.props;\n\n    return (\n      <div>\n        <h2>Posts ({posts.length})</h2>\n        <button className=\"admin__log-out\" onClick={this.onNewPostClick}>\n          New Post\n        </button>\n        <Search showing={posts.length} total={posts.length} />\n        <div className=\"admin__filters\">\n          <div className=\"admin__filter\">\n            <input\n              type=\"checkbox\"\n              onChange={() => this.setState({ showNeedsWork: !showNeedsWork })}\n              value={showNeedsWork}\n            />\n            Needs work\n          </div>\n        </div>\n        {showNeedsWork ? this.renderNeedsWork() : this.renderAll()}\n      </div>\n    );\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAGA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAhBA;AAkBA;AACA;AAxCA;AA0CA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AA7CA;AAEA;AACA;AADA;AALA;AAQA;AACA;;;AACA;AACA;AACA;AACA;;;AAEA;AACA;AACA;AACA;;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAIA;AACA;;;AAEA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAGA;AAeA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAGA;AAAA;AAGA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAIA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAKA;AAKA;AAGA;;;AAEA;AAAA;AACA;AADA;AAAA;AAIA;AAGA;AAAA;AAAA;AAGA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAHA;AAWA;;;;AA1KA;AACA;;;;;A","sourceRoot":""}