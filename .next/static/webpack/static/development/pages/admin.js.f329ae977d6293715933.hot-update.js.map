{"version":3,"file":"static/webpack/static/development/pages/admin.js.f329ae977d6293715933.hot-update.js","sources":["webpack:///./components/AdminPostsList.js"],"sourcesContent":["import React, { Component } from \"react\";\nimport { some } from \"lodash\";\nimport styled from \"styled-components\";\n\nimport Search from \"./Search\";\nimport ListItem from \"./ListItem\";\n\nconst BIBLE_BOOKS = {\n  Genesis: true,\n  Exodus: true,\n  Leviticus: true,\n  Numbers: true,\n  Deuteronomy: true,\n  Joshua: true,\n  Judges: true,\n  Ruth: true,\n  \"1 Samuel\": true,\n  \"2 Samuel\": true,\n  \"1 Kings\": true,\n  \"2 Kings\": true,\n  \"1 Chronicles\": true,\n  \"2 Chronicles\": true,\n  Ezra: true,\n  Nehemiah: true,\n  Esther: true,\n  Job: true,\n  Psalms: true,\n  Proverbs: true,\n  Ecclesiastes: true,\n  \"Song of Solomon\": true,\n  Isaiah: true,\n  Jeremiah: true,\n  Lamentations: true,\n  Ezekiel: true,\n  Daniel: true,\n  Hosea: true,\n  Joel: true,\n  Amos: true,\n  Obadiah: true,\n  Jonah: true,\n  Micah: true,\n  Nahum: true,\n  Habakkuk: true,\n  Zephaniah: true,\n  Haggai: true,\n  Zechariah: true,\n  Malachi: true,\n  Matthew: true,\n  Mark: true,\n  Luke: true,\n  John: true,\n  Acts: true,\n  Romans: true,\n  \"1 Corinthians\": true,\n  \"2 Corinthians\": true,\n  Galatians: true,\n  Ephesians: true,\n  Philippians: true,\n  Colossians: true,\n  \"1 Thessalonians\": true,\n  \"2 Thessalonians\": true,\n  \"1 Timothy\": true,\n  \"2 Timothy\": true,\n  Titus: true,\n  Philemon: true,\n  Hebrews: true,\n  James: true,\n  \"1 Peter\": true,\n  \"2 Peter\": true,\n  \"1 John\": true,\n  \"2 John\": true,\n  \"3 John\": true,\n  Jude: true,\n  Revelation: true\n};\n\nconst PostItem = styled.div`\n  align-items: center;\n  display: flex;\n`;\n\nconst PostInfo = styled.div`\n  flex-grow: 1;\n  font-size: 20px;\n  font-weight: bold;\n`;\n\nexport default class PostsList extends Component {\n  constructor(props) {\n    super(props);\n\n    this.keys = {};\n\n    this.state = {\n      showNeedsWork: false\n    };\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"keydown\", this.handleKeyPress);\n    document.addEventListener(\"keyup\", this.handleKeyPress);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keydown\", this.handleKeyPress);\n    document.removeEventListener(\"keyup\", this.handleKeyPress);\n  }\n\n  onNewPostClick = () => {\n    this.props.onSetPost({\n      published: false,\n      slug: \"\",\n      title: \"\",\n      description: \"\",\n      subtitle: \"\",\n      image_url: \"\",\n      image_url_small: \"\",\n      references: \"\",\n      html: `<div class=\"writing\">\n  <h3>Initial</h3>\n</div>`,\n      date_added: \"\",\n      related_posts_tags: [],\n      mapped_related_posts_tags: [],\n      tag_ids: [],\n      tags: []\n    });\n  };\n\n  handleKeyPress = e => {\n    this.keys[e.keyCode] = e.type === \"keydown\";\n\n    if (this.keys[17] && this.keys[78]) {\n      this.setState({ showNeedsWork: !this.state.showNeedsWork });\n    }\n  };\n\n  needsWork(post) {\n    const errors = [];\n\n    if (!post.published) {\n      errors.push(\"Not published\");\n    }\n\n    if (!post.tags.length) {\n      errors.push(\"No tags\");\n    }\n    console.log(\"======\", post);\n    if (!post.related_posts_tags) {\n      errors.push(\"No related posts\");\n    }\n\n    if (!post.description || post.description.length < 160) {\n      errors.push(\"Needs description\");\n    }\n\n    return errors;\n  }\n\n  renderAll() {\n    return this.props.posts.map(post => {\n      return (\n        <PostItem key={post.id} onClick={() => this.props.onSetPost(post)}>\n          <PostInfo>{post.title}</PostInfo>\n          {post.image_url_small ? (\n            <img src={post.image_url_small} alt={post.title} />\n          ) : null}\n        </PostItem>\n      );\n    });\n  }\n\n  renderNeedsWork() {\n    const { onSetPost, posts, postsBySlug, tags } = this.props;\n\n    return (\n      <div>\n        {/* {posts.map(post => {\n          if (post.tags.length) {\n            return null;\n          }\n\n          return (\n            <div key={post.id} onClick={() => onSetPost(post)}>\n              <div>{post.title}</div>\n              <div style={{ color: \"red\" }}>Needs tag</div>\n            </div>\n          );\n        })} */}\n        {tags.map(tag => {\n          if (\n            tag.slug === \"apologetics\" ||\n            tag.slug === \"theology\" ||\n            BIBLE_BOOKS[tag.title]\n          ) {\n            return null;\n          }\n\n          return (\n            <div key={tag.id} className=\"writing\">\n              {some(\n                tag.post_slugs,\n                slug => this.needsWork(postsBySlug[slug]).length\n              ) ? (\n                <div>\n                  <h4 className=\"nomargin\">{tag.title}</h4>\n                  {tag.post_slugs.map(slug => {\n                    const post = postsBySlug[slug];\n\n                    const needsWork = this.needsWork(post);\n\n                    if (!needsWork.length) {\n                      return null;\n                    }\n\n                    const needsWorkErrors = needsWork.map(error => {\n                      return (\n                        <div key={error} style={{ color: \"red\" }}>\n                          {error}\n                        </div>\n                      );\n                    });\n\n                    return (\n                      <div\n                        key={`${tag.slug}-\n                        **${post.slug}`}\n                        onClick={() => onSetPost(post)}\n                      >\n                        <div>{post.title}</div>\n                        {needsWorkErrors}\n                      </div>\n                    );\n                  })}\n                </div>\n              ) : null}\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n\n  render() {\n    const { showNeedsWork } = this.state;\n    const { posts } = this.props;\n\n    return (\n      <div>\n        <h2>Posts ({posts.length})</h2>\n        <button className=\"admin__log-out\" onClick={this.onNewPostClick}>\n          New Post\n        </button>\n        <Search showing={posts.length} total={posts.length} />\n        <div className=\"admin__filters\">\n          <div className=\"admin__filter\">\n            <input\n              type=\"checkbox\"\n              onChange={() => this.setState({ showNeedsWork: !showNeedsWork })}\n              value={showNeedsWork}\n            />\n            Needs work\n          </div>\n        </div>\n        {showNeedsWork ? this.renderNeedsWork() : this.renderAll()}\n      </div>\n    );\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlEA;AAqEA;AAKA;AACA;AAKA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AAhBA;AAkBA;AACA;AAxCA;AA0CA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AA7CA;AAEA;AACA;AADA;AALA;AAQA;AACA;;;AACA;AACA;AACA;AACA;;;AAEA;AACA;AACA;AACA;;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAIA;AACA;;;AAEA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAGA;AAeA;AAKA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAGA;AAAA;AAGA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAIA;AAEA;AAEA;AAEA;AAAA;AAAA;AAHA;AASA;AAKA;AAGA;;;AAEA;AAAA;AACA;AADA;AAAA;AAIA;AAGA;AAAA;AAAA;AAGA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAHA;AAWA;;;;AApLA;AACA;;;;;A","sourceRoot":""}